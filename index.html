<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Pansou Ultra Pro - 旗舰聚合搜索</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;700;900&display=swap');
        body { font-family: 'Noto Sans SC', sans-serif; background-color: #050505; color: #f8fafc; overflow-x: hidden; }
        
        .glass-header { background: rgba(10, 10, 10, 0.85); backdrop-filter: blur(20px); border-bottom: 1px solid rgba(255, 255, 255, 0.05); }
        
        .search-container { position: relative; z-index: 10; }
        .search-glow {
            background: linear-gradient(90deg, #f59e0b, #ea580c, #f59e0b);
            background-size: 200% auto;
            animation: move-bg 3s linear infinite;
        }
        @keyframes move-bg { 0% { background-position: 0% center; } 100% { background-position: 200% center; } }

        .result-card {
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid rgba(255, 255, 255, 0.05);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .result-card:active { transform: scale(0.97); background: rgba(255, 255, 255, 0.05); }

        .aliyun-badge { background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); color: #000; }
        .aliyun-premium { border-color: rgba(245, 158, 11, 0.3); background: linear-gradient(180deg, rgba(245, 158, 11, 0.05) 0%, transparent 100%); }

        .shimmer {
            overflow: hidden;
            position: relative;
        }
        .shimmer::after {
            content: ''; position: absolute; top: 0; left: -100%; width: 50%; height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.05), transparent);
            transform: skewX(-20deg); animation: shine 4s infinite;
        }
        @keyframes shine { 0% { left: -100%; } 20% { left: 200%; } 100% { left: 200%; } }

        /* 隐藏滚动条 */
        ::-webkit-scrollbar { width: 0; }
    </style>
</head>
<body class="antialiased min-h-screen">

    <!-- 顶部导航 -->
    <nav class="sticky top-0 z-50 glass-header px-4 py-4 flex items-center justify-between">
        <div class="flex items-center gap-2">
            <div class="p-1.5 rounded-lg bg-orange-600 shadow-lg shadow-orange-600/20">
                <i data-lucide="layers" class="text-white w-5 h-5"></i>
            </div>
            <span class="text-xl font-black text-white italic tracking-tighter uppercase">Ultra Pan</span>
        </div>
        <div id="statusIndicator" class="flex items-center gap-2 px-3 py-1 rounded-full bg-green-500/10 border border-green-500/20">
            <span class="w-1.5 h-1.5 rounded-full bg-green-500 animate-pulse"></span>
            <span class="text-[9px] font-bold text-green-500 uppercase tracking-widest">Core Active</span>
        </div>
    </nav>

    <main class="max-w-xl mx-auto px-4 pt-8 pb-32">
        <!-- 搜索头部 -->
        <div class="text-center mb-8">
            <h1 class="text-3xl font-black text-white mb-6 tracking-tight">聚合搜索 · 臻彩 4K</h1>
            
            <form id="searchForm" class="search-container">
                <div class="absolute -inset-1 search-glow rounded-2xl opacity-20 blur-sm"></div>
                <div class="relative flex items-center bg-[#0a0a0a] rounded-2xl border border-white/10 shadow-2xl overflow-hidden">
                    <div class="pl-4 text-slate-500"><i data-lucide="search" class="w-5 h-5"></i></div>
                    <input type="text" id="searchInput" placeholder="请输入影片关键词..." 
                           class="w-full bg-transparent border-none py-4 px-3 text-base text-white outline-none focus:ring-0 placeholder-slate-600">
                    <button type="submit" class="mr-2 bg-white text-black font-black px-6 py-2 rounded-xl active:scale-95 transition-all">搜索</button>
                </div>
            </form>

            <div id="countDisplay" class="mt-4 text-[10px] font-bold text-slate-600 uppercase tracking-[0.2em] hidden">
                Found <span id="resCount" class="text-orange-500">0</span> indexed resources
            </div>
        </div>

        <!-- 结果展示 -->
        <div id="resultsList" class="space-y-3">
            <!-- 初始引导卡片 -->
            <div class="grid grid-cols-2 gap-3 mt-4">
                <div class="p-4 rounded-2xl bg-white/[0.02] border border-white/5 flex flex-col items-center gap-2">
                    <i data-lucide="film" class="text-orange-500 w-5 h-5"></i>
                    <span class="text-[10px] font-bold text-slate-400">4K 臻彩</span>
                </div>
                <div class="p-4 rounded-2xl bg-white/[0.02] border border-white/5 flex flex-col items-center gap-2">
                    <i data-lucide="headphones" class="text-blue-400 w-5 h-5"></i>
                    <span class="text-[10px] font-bold text-slate-400">杜比全景声</span>
                </div>
            </div>
        </div>
    </main>

    <!-- 底部常驻进群卡片 -->
    <div class="fixed bottom-6 left-4 right-4 z-40">
        <div class="glass-header p-4 rounded-3xl border border-orange-500/20 shadow-2xl flex items-center justify-between shadow-orange-500/10">
            <div class="flex items-center gap-3">
                <div class="bg-orange-500/10 p-2.5 rounded-2xl text-orange-500">
                    <i data-lucide="users" class="w-5 h-5"></i>
                </div>
                <div class="text-left">
                    <p class="text-sm font-bold text-white tracking-tight">加入内部 80T 放映室</p>
                    <p class="text-[10px] text-slate-500 font-bold uppercase tracking-tighter">Daily 4K Drops / Atmos</p>
                </div>
            </div>
            <button class="bg-orange-600 text-white text-[10px] font-black px-4 py-2.5 rounded-xl active:scale-90 shadow-lg shadow-orange-600/30">立即进群</button>
        </div>
    </div>

    <script>
        // 直接请求官网接口，配合 raw 代理确保数据完整
        const API_BASE = "https://so.252035.xyz/search";

        document.getElementById('searchForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const query = document.getElementById('searchInput').value.trim();
            const list = document.getElementById('resultsList');
            const countDisplay = document.getElementById('countDisplay');
            const resCount = document.getElementById('resCount');

            if (!query) return;
            document.getElementById('searchInput').blur();

            // 进入加载状态
            list.innerHTML = `
                <div class="py-20 text-center">
                    <div class="w-8 h-8 border-2 border-orange-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"></div>
                    <p class="text-[10px] font-bold text-slate-500 uppercase tracking-widest">正在全网挖掘...</p>
                </div>
            `;
            countDisplay.classList.add('hidden');

            try {
                // 使用 raw 代理，不遗漏任何数据
                const proxyUrl = `https://api.allorigins.win/raw?url=${encodeURIComponent(API_BASE + '?q=' + query)}`;
                const response = await fetch(proxyUrl);
                const data = await response.json();

                // 获取数组，兼容不同返回格式
                const items = data.list || data.data || data || [];

                if (items.length === 0) {
                    list.innerHTML = `<div class="py-20 text-center opacity-40 italic text-sm">未找到相关资源，换个词试试？</div>`;
                } else {
                    resCount.innerText = items.length;
                    countDisplay.classList.remove('hidden');
                    renderResults(items);
                }

            } catch (err) {
                list.innerHTML = `<div class="py-12 px-6 text-center bg-red-500/5 border border-red-500/20 rounded-3xl text-xs font-bold text-red-400 uppercase">接口繁忙，请点击搜索重试</div>`;
            }
        });

        function renderResults(items) {
            const list = document.getElementById('resultsList');
            
            // 排序：阿里云盘 -> 夸克 -> 磁力 -> 其他
            items.sort((a, b) => {
                const getScore = (item) => {
                    const src = (item.source || '').toLowerCase();
                    const link = (item.link || '').toLowerCase();
                    if (src.includes('阿里') || link.includes('aliyundrive')) return 100;
                    if (src.includes('夸克') || link.includes('quark')) return 50;
                    return 0;
                };
                return getScore(b) - getScore(a);
            });

            let html = '';
            items.forEach(item => {
                const source = (item.source || '全网资源').toUpperCase();
                const isAli = source.includes('阿里') || (item.link || '').includes('aliyundrive');
                const title = item.title || '未知资源名称';
                const size = item.size || 'HD';
                
                html += `
                    <div class="result-card p-4 rounded-2xl flex flex-col gap-3 ${isAli ? 'aliyun-premium shimmer' : ''}">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center gap-2">
                                <span class="px-1.5 py-0.5 rounded-[4px] text-[8px] font-black uppercase tracking-tighter ${isAli ? 'aliyun-badge' : 'bg-white/10 text-slate-500'}">
                                    ${source}
                                </span>
                                <span class="text-[9px] font-mono font-bold text-slate-600 tracking-tighter">${size}</span>
                            </div>
                            ${isAli ? '<i data-lucide="sparkles" class="w-3 h-3 text-orange-500"></i>' : ''}
                        </div>
                        
                        <h3 class="text-[13px] font-bold leading-tight ${isAli ? 'text-white' : 'text-slate-400'} line-clamp-2">
                            ${title}
                        </h3>

                        <div class="flex gap-2">
                            ${title.includes('4K') || title.includes('臻彩') ? '<span class="text-[8px] font-black text-orange-500/80 border border-orange-500/20 px-1.5 py-0.5 rounded tracking-tighter uppercase italic bg-orange-500/5">Premium 4K</span>' : ''}
                            ${title.includes('杜比') ? '<span class="text-[8px] font-black text-blue-400 border border-blue-400/20 px-1.5 py-0.5 rounded tracking-tighter uppercase italic bg-blue-500/5">Dolby</span>' : ''}
                        </div>
                        
                        <a href="${item.link}" target="_blank" class="mt-1 w-full text-center py-2.5 rounded-xl text-[10px] font-black transition-all ${isAli ? 'bg-white text-black' : 'bg-white/5 text-slate-500'}">
                            ${isAli ? '存入 80T 阿里云盘' : '查看资源链接'}
                        </a>
                    </div>
                `;
            });
            list.innerHTML = html;
            lucide.createIcons();
        }

        window.onload = () => { lucide.createIcons(); };
    </script>
</body>
</html>